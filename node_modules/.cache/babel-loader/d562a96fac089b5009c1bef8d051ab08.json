{"ast":null,"code":"var _jsxFileName = \"/Users/haesol/Desktop/mediround-user-web-master/src/pages/Forgot.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useAuthContext } from \"../auth/auth\";\nimport { getUser } from \"../aws/UserPool\";\nimport Button from \"../components/Button/Button\";\nimport InfoInput from \"../components/Input/InfoInput\";\nimport { phoneLocaleList } from \"../utils\";\nimport \"./Forgot.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Forgot = props => {\n  _s();\n\n  const auth = useAuthContext();\n  const [phoneDigit, setPhoneDigit] = useState(\"\");\n  const [phoneLocale, setPhoneLocale] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [isCodeSent, setIsCodeSent] = useState(false);\n  const [cachedPhone, setCachedPhone] = useState(\"\");\n  const [codeRecvInProgress, setCodeRecvInProgress] = useState(false);\n  const [code, setCode] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [rePassword, setRePassword] = useState(\"\");\n  const [isChangePwdInProgress, setIsChangePwdInProgress] = useState(false);\n  useEffect(() => {\n    // Determines phone number i.e. username\n    const fullPhone = phoneLocale + phoneDigit;\n    setPhone(fullPhone);\n  }, [phoneLocale, phoneDigit]);\n\n  const forgotPasswdHandler = () => {\n    setCodeRecvInProgress(true);\n    getUser(phone).forgotPassword({\n      onSuccess: data => {\n        console.log(\"onSuccsess:\", data);\n      },\n      onFailure: err => {\n        setCodeRecvInProgress(false);\n        console.error(\"onFailure:\", err);\n      },\n      inputVerificationCode: data => {\n        setCachedPhone(phone);\n        setIsCodeSent(true);\n        setCodeRecvInProgress(false);\n      }\n    });\n  };\n\n  const resendCodeHandler = () => {\n    setCodeRecvInProgress(true);\n    getUser(cachedPhone).resendConfirmationCode(err => {\n      if (err) {\n        console.error(err);\n      } else {\n        setCodeRecvInProgress(false);\n      }\n    });\n  };\n\n  const changePasswdHandler = () => {\n    setIsChangePwdInProgress(true); // TODO: show Error message if password and rePassword are different\n\n    getUser(cachedPhone).confirmPassword(code, password, {\n      onSuccess: () => {\n        auth === null || auth === void 0 ? void 0 : auth.authenticate(cachedPhone, password).then(() => {\n          props.history.push(\"/mypage\");\n        }).catch(err => {\n          setIsChangePwdInProgress(false);\n          console.error(err);\n        });\n      },\n      onFailure: err => {\n        setIsChangePwdInProgress(false);\n        console.error(\"onFailure:\", err);\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"forgot-page-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"forgot-page-title\",\n      children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n        id: \"logIn.forgotYourPassword\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"forgot-page-sub-title\",\n      children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n        id: \"forget.text\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(InfoInput, {\n      title: \"Phone number\",\n      titleId: \"logIn.phone\",\n      type: \"tel\",\n      value: phoneDigit,\n      onChange: e => setPhoneDigit(e.target.value),\n      buttonText: isCodeSent && phone === cachedPhone ? \"재전송\" : \"코드 전송\",\n      buttonDisabled: phoneDigit === \"\",\n      onButtonClick: isCodeSent && phone === cachedPhone ? resendCodeHandler : forgotPasswdHandler,\n      buttonLoading: codeRecvInProgress,\n      optionVals: phoneLocaleList.map(obj => obj.value),\n      optionKeys: phoneLocaleList.map(obj => obj.icon + \" \" + obj.value),\n      onSelectChange: e => setPhoneLocale(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), isCodeSent && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(InfoInput, {\n        title: \"Code\",\n        value: code,\n        onChange: e => setCode(e.target.value),\n        width: \"calc(100% - 144px)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InfoInput, {\n        title: \"New password (at least 8 characters)\",\n        type: \"password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(InfoInput, {\n        title: \"Re-enter new password\",\n        type: \"password\",\n        value: rePassword,\n        onChange: e => setRePassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        text: \"Change password\",\n        textId: \"button.changePassword\",\n        shape: \"round\",\n        theme: \"primary\",\n        isDisabled: code === \"\" || password === \"\" || rePassword === \"\" || password !== rePassword,\n        isLoading: isChangePwdInProgress,\n        onClick: changePasswdHandler\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Forgot, \"nlqKVJTB9bDi4zTQW8dLrFTwusY=\", false, function () {\n  return [useAuthContext];\n});\n\n_c = Forgot;\nexport default Forgot;\n\nvar _c;\n\n$RefreshReg$(_c, \"Forgot\");","map":{"version":3,"sources":["/Users/haesol/Desktop/mediround-user-web-master/src/pages/Forgot.tsx"],"names":["React","useState","useEffect","useAuthContext","getUser","Button","InfoInput","phoneLocaleList","FormattedMessage","Forgot","props","auth","phoneDigit","setPhoneDigit","phoneLocale","setPhoneLocale","phone","setPhone","isCodeSent","setIsCodeSent","cachedPhone","setCachedPhone","codeRecvInProgress","setCodeRecvInProgress","code","setCode","password","setPassword","rePassword","setRePassword","isChangePwdInProgress","setIsChangePwdInProgress","fullPhone","forgotPasswdHandler","forgotPassword","onSuccess","data","console","log","onFailure","err","error","inputVerificationCode","resendCodeHandler","resendConfirmationCode","changePasswdHandler","confirmPassword","authenticate","then","history","push","catch","e","target","value","map","obj","icon"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport { useAuthContext } from \"../auth/auth\";\nimport { getUser } from \"../aws/UserPool\";\nimport Button from \"../components/Button/Button\";\nimport InfoInput from \"../components/Input/InfoInput\";\nimport { phoneLocaleList } from \"../utils\";\nimport \"./Forgot.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst Forgot = (props: RouteComponentProps) => {\n  const auth = useAuthContext();\n  const [phoneDigit, setPhoneDigit] = useState(\"\");\n  const [phoneLocale, setPhoneLocale] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [isCodeSent, setIsCodeSent] = useState(false);\n  const [cachedPhone, setCachedPhone] = useState(\"\");\n  const [codeRecvInProgress, setCodeRecvInProgress] = useState(false);\n  const [code, setCode] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [rePassword, setRePassword] = useState(\"\");\n  const [isChangePwdInProgress, setIsChangePwdInProgress] = useState(false);\n\n  useEffect(() => {\n    // Determines phone number i.e. username\n    const fullPhone = phoneLocale + phoneDigit;\n    setPhone(fullPhone);\n  }, [phoneLocale, phoneDigit]);\n\n  const forgotPasswdHandler = () => {\n    setCodeRecvInProgress(true);\n    getUser(phone).forgotPassword({\n      onSuccess: (data) => {\n        console.log(\"onSuccsess:\", data);\n      },\n      onFailure: (err) => {\n        setCodeRecvInProgress(false);\n        console.error(\"onFailure:\", err);\n      },\n      inputVerificationCode: (data) => {\n        setCachedPhone(phone);\n        setIsCodeSent(true);\n        setCodeRecvInProgress(false);\n      },\n    });\n  };\n\n  const resendCodeHandler = () => {\n    setCodeRecvInProgress(true);\n    getUser(cachedPhone).resendConfirmationCode((err) => {\n      if (err) {\n        console.error(err);\n      } else {\n        setCodeRecvInProgress(false);\n      }\n    });\n  };\n\n  const changePasswdHandler = () => {\n    setIsChangePwdInProgress(true);\n    // TODO: show Error message if password and rePassword are different\n    getUser(cachedPhone).confirmPassword(code, password, {\n      onSuccess: () => {\n        auth\n          ?.authenticate(cachedPhone, password)\n          .then(() => {\n            props.history.push(\"/mypage\");\n          })\n          .catch((err) => {\n            setIsChangePwdInProgress(false);\n            console.error(err);\n          });\n      },\n      onFailure: (err) => {\n        setIsChangePwdInProgress(false);\n        console.error(\"onFailure:\", err);\n      },\n    });\n  };\n\n  return (\n    <div className=\"forgot-page-container\">\n      <div className=\"forgot-page-title\">\n        <FormattedMessage id=\"logIn.forgotYourPassword\" />\n      </div>\n      <div className=\"forgot-page-sub-title\">\n        <FormattedMessage id=\"forget.text\" />\n      </div>\n      <InfoInput\n        title=\"Phone number\"\n        titleId=\"logIn.phone\"\n        type=\"tel\"\n        value={phoneDigit}\n        onChange={(e) => setPhoneDigit(e.target.value)}\n        buttonText={\n          isCodeSent && phone === cachedPhone ? \"재전송\" : \"코드 전송\"\n        }\n        buttonDisabled={phoneDigit === \"\"}\n        onButtonClick={\n          isCodeSent && phone === cachedPhone\n            ? resendCodeHandler\n            : forgotPasswdHandler\n        }\n        buttonLoading={codeRecvInProgress}\n        optionVals={phoneLocaleList.map((obj) => obj.value)}\n        optionKeys={phoneLocaleList.map((obj) => obj.icon + \" \" + obj.value)}\n        onSelectChange={(e) => setPhoneLocale(e.target.value)}\n      />\n      {isCodeSent && (\n        <>\n          <InfoInput\n            title=\"Code\"\n            value={code}\n            onChange={(e) => setCode(e.target.value)}\n            width=\"calc(100% - 144px)\"\n          />\n          <InfoInput\n            title=\"New password (at least 8 characters)\"\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          <InfoInput\n            title=\"Re-enter new password\"\n            type=\"password\"\n            value={rePassword}\n            onChange={(e) => setRePassword(e.target.value)}\n          />\n          <Button\n            text=\"Change password\"\n            textId=\"button.changePassword\"\n            shape=\"round\"\n            theme=\"primary\"\n            isDisabled={\n              code === \"\" ||\n              password === \"\" ||\n              rePassword === \"\" ||\n              password !== rePassword\n            }\n            isLoading={isChangePwdInProgress}\n            onClick={changePasswdHandler}\n          />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default Forgot;\n"]},"metadata":{},"sourceType":"module"}