{"ast":null,"code":"import _regeneratorRuntime from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{getHospital}from\"../../api/hospital\";import Button from\"../../components/Button/Button\";import CalendarCarousel from\"../../components/Input/CalendarCarousel\";import TimeMultipleSelection from\"../../components/Input/TimeMultipleSelection\";import hospital_profile_default from\"../../images/hospital_profile_default.svg\";import{Loading}from\"../Hospital/Containers/Request\";import moment from\"moment\";import\"moment-timezone\";import\"./Reserve.scss\";import{msOneHour}from\"../../utils\";import{matchQuote}from\"../../api/quote\";import{FormattedMessage}from\"react-intl\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Reserve=function Reserve(props){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSending=_useState4[0],setIsSending=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),date=_useState6[0],setDate=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),fullDate=_useState8[0],setFullDate=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),time=_useState10[0],setTime=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),hospital=_useState12[0],setHospital=_useState12[1];useEffect(function(){setIsLoading(true);var initHospital=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var hospitalData,hospital;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getHospital({hid:props.match.params.hid});case 2:hospitalData=_context.sent;hospital=hospitalData.result;setHospital(hospital);case 5:case\"end\":return _context.stop();}}},_callee);}));return function initHospital(){return _ref.apply(this,arguments);};}();initHospital().then(function(){setIsLoading(false);}).catch(function(e){console.error(\"Reserve\",e);setIsLoading(false);});},[]);var matchQuoteHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var t,consultTime,isSuccess;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsSending(true);t=moment.tz(\"\".concat(fullDate,\" \").concat(time),\"Asia/Seoul\");consultTime=t.valueOf()+msOneHour;_context2.next=5;return matchQuote({hid:props.match.params.hid,qid:props.match.params.qid,consultTime:consultTime});case 5:isSuccess=_context2.sent;if(isSuccess){setIsSending(false);props.history.push(\"/mypage/waiting\");}else{setIsSending(false);// TODO: show modal error\n}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function matchQuoteHandler(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"reserve-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reserve-hospital-desc-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"reserve-hospital-header-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"reserve-hospital-profile-container\",children:/*#__PURE__*/_jsx(\"img\",{className:\"reserve-hospital-profile-img\",src:hospital_profile_default,alt:\"hospital_profile_img\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"reserve-hospital-name\",children:hospital===null||hospital===void 0?void 0:hospital.name})]}),/*#__PURE__*/_jsx(\"div\",{className:\"reserve-hospital-body-container\",children:hospital===null||hospital===void 0?void 0:hospital.about})]}),/*#__PURE__*/_jsx(\"div\",{className:\"reserve-subtitle\",children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"reserve.date\"})}),/*#__PURE__*/_jsx(CalendarCarousel,{date:date,setDate:setDate,setFullDate:setFullDate}),/*#__PURE__*/_jsx(\"div\",{className:\"reserve-subtitle\",children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"reserve.time\"})}),/*#__PURE__*/_jsx(TimeMultipleSelection,{time:time,setTime:setTime}),/*#__PURE__*/_jsx(\"div\",{className:\"reserve-footer-button-container\",children:/*#__PURE__*/_jsx(Button,{text:\"Reserve\",textId:\"button.reserve\",shape:\"round\",theme:\"primary\",isLoading:isSending,onClick:matchQuoteHandler})})]})});};export default Reserve;","map":{"version":3,"sources":["/Users/haesol/Desktop/mediround-user-web/src/pages/My/Reserve.tsx"],"names":["React","useEffect","useState","getHospital","Button","CalendarCarousel","TimeMultipleSelection","Loading","moment","msOneHour","matchQuote","FormattedMessage","Reserve","props","isLoading","setIsLoading","isSending","setIsSending","date","setDate","fullDate","setFullDate","time","setTime","hospital","setHospital","initHospital","hid","match","params","hospitalData","result","then","catch","e","console","error","matchQuoteHandler","t","tz","consultTime","valueOf","qid","isSuccess","history","push","hospital_profile_default","name","about"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport { getHospital } from \"../../api/hospital\";\nimport Button from \"../../components/Button/Button\";\nimport CalendarCarousel from \"../../components/Input/CalendarCarousel\";\nimport TimeMultipleSelection from \"../../components/Input/TimeMultipleSelection\";\nimport hospital_profile_default from \"../../images/hospital_profile_default.svg\";\nimport { Hospital } from \"../Hospital/Containers/Preview\";\nimport { Loading } from \"../Hospital/Containers/Request\";\nimport moment from \"moment\";\nimport \"moment-timezone\";\nimport \"./Reserve.scss\";\nimport { msOneHour } from \"../../utils\";\nimport { matchQuote } from \"../../api/quote\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst Reserve = (props: RouteComponentProps<any>) => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [date, setDate] = useState(\"\");\n  const [fullDate, setFullDate] = useState(\"\");\n  const [time, setTime] = useState(\"\");\n  const [hospital, setHospital] = useState<Hospital>();\n\n  useEffect(() => {\n    setIsLoading(true);\n    const initHospital = async () => {\n      // TODO: get hospital ID\n      const hospitalData = await getHospital({ hid: props.match.params.hid });\n      const hospital = hospitalData.result;\n      setHospital(hospital);\n    };\n    initHospital()\n      .then(() => {\n        setIsLoading(false);\n      })\n      .catch((e) => {\n        console.error(\"Reserve\", e);\n        setIsLoading(false);\n      });\n  }, []);\n\n  const matchQuoteHandler = async () => {\n    setIsSending(true);\n    const t = moment.tz(`${fullDate} ${time}`, \"Asia/Seoul\");\n    const consultTime = t.valueOf() + msOneHour;\n    const isSuccess = await matchQuote({\n      hid: props.match.params.hid,\n      qid: props.match.params.qid,\n      consultTime,\n    });\n    if (isSuccess) {\n      setIsSending(false);\n      props.history.push(\"/mypage/waiting\");\n    } else {\n      setIsSending(false);\n      // TODO: show modal error\n    }\n  };\n\n  return (\n    <>\n      {isLoading ? (\n        <Loading />\n      ) : (\n        <div className=\"reserve-container\">\n          <div className=\"reserve-hospital-desc-container\">\n            <div className=\"reserve-hospital-header-container\">\n              <div className=\"reserve-hospital-profile-container\">\n                <img\n                  className=\"reserve-hospital-profile-img\"\n                  src={hospital_profile_default}\n                  alt=\"hospital_profile_img\"\n                />\n              </div>\n              <div className=\"reserve-hospital-name\">{hospital?.name!}</div>\n            </div>\n            <div className=\"reserve-hospital-body-container\">\n              {hospital?.about!}\n            </div>\n          </div>\n          <div className=\"reserve-subtitle\">\n            <FormattedMessage id=\"reserve.date\" />\n          </div>\n          <CalendarCarousel\n            date={date}\n            setDate={setDate}\n            setFullDate={setFullDate}\n          />\n          <div className=\"reserve-subtitle\">\n            <FormattedMessage id=\"reserve.time\" />\n          </div>\n          <TimeMultipleSelection time={time} setTime={setTime} />\n          <div className=\"reserve-footer-button-container\">\n            <Button\n              text=\"Reserve\"\n              textId=\"button.reserve\"\n              shape=\"round\"\n              theme=\"primary\"\n              isLoading={isSending}\n              onClick={matchQuoteHandler}\n            />\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Reserve;\n"]},"metadata":{},"sourceType":"module"}