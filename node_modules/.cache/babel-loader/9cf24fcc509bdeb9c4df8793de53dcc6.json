{"ast":null,"code":"import _regeneratorRuntime from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/haesol/Desktop/mediround-user-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import Dimmer from\"../Dimmer/Dimmer\";import\"./Sidebar.scss\";import sidebar_x_icon from\"../../images/sidebar-x.svg\";import sidebar_home_icon from\"../../images/sidebar-home-icon.svg\";import karamel_logo from\"../../images/karamel-logo.png\";import{useAuthContext}from\"../../auth/auth\";import{withRouter}from\"react-router\";import{useSelector}from\"react-redux\";import{getUser}from\"../../api/user\";import{FormattedMessage}from\"react-intl\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Sidebar=function Sidebar(props){var auth=useAuthContext();var sideBarRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAuthenticated=_useState2[0],setIsAuthenticated=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userName=_useState4[0],setUserName=_useState4[1];var user=useSelector(function(state){return state.user.current;});var onClickOutsideSidebarHandler=function onClickOutsideSidebarHandler(e){var _sideBarRef$current;if(props.isSidebarOpened&&!((_sideBarRef$current=sideBarRef.current)===null||_sideBarRef$current===void 0?void 0:_sideBarRef$current.contains(e.target))){props.sidebarCloseCallback();}};var signOutHandler=function signOutHandler(){auth===null||auth===void 0?void 0:auth.logout();props.sidebarCloseCallback();props.history.push(\"/landing\");};var goSignIn=function goSignIn(){props.sidebarCloseCallback();props.history.push(\"/signin\");};var goMypage=function goMypage(){props.sidebarCloseCallback();props.history.push(\"/mypage\");};var goForm=function goForm(){props.sidebarCloseCallback();props.history.push(\"/form\");};var goHospitalSignIn=function goHospitalSignIn(){props.sidebarCloseCallback();props.history.push(\"/hospital/signin\");};useEffect(function(){var getUserName=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var sub,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:sub=user.sub;if(!sub){_context.next=6;break;}_context.next=4;return getUser({sub:sub});case 4:res=_context.sent;return _context.abrupt(\"return\",res.result.name);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getUserName(){return _ref.apply(this,arguments);};}();var isAuthValid=Object.keys(user).length!==0;setIsAuthenticated(isAuthValid);if(isAuthValid){getUserName().then(function(name){return setUserName(name);});}},[user]);useEffect(function(){window.addEventListener(\"click\",onClickOutsideSidebarHandler);return function(){return window.removeEventListener(\"click\",onClickOutsideSidebarHandler);};});return/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-content \".concat(props.isSidebarOpened&&\"show\"),ref:sideBarRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-exit-icon-box \".concat(props.isSidebarOpened&&\"show\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-title\",children:/*#__PURE__*/_jsx(\"img\",{className:\"sidebar-logo\",src:karamel_logo,alt:\"logo\"})}),/*#__PURE__*/_jsx(\"img\",{className:\"sidebar-exit-icon\",src:sidebar_x_icon,onClick:props.sidebarCloseCallback,alt:\"sidebar-exit-icon\"}),isAuthenticated&&/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-greetings\",children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.greeting\",values:{name:userName}})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-title-item \".concat(props.isSidebarOpened&&\"show\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-menu-title-content\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"sidebar-menu-title-home-icon\",src:sidebar_home_icon,alt:\"sidebar-home-icon\"}),/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.user\"})]})}),!isAuthenticated&&/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-item \".concat(props.isSidebarOpened&&\"show\"),onClick:goSignIn,children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.login\"})}),isAuthenticated&&/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-item \".concat(props.isSidebarOpened&&\"show\"),onClick:goMypage,children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.myPage\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-item \".concat(props.isSidebarOpened&&\"show\"),onClick:goForm,children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.findHospitals\"})}),isAuthenticated&&/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-item \".concat(props.isSidebarOpened&&\"show\"),onClick:signOutHandler,children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.logout\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-title-item \".concat(props.isSidebarOpened&&\"show\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-menu-title-content\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"sidebar-menu-title-home-icon\",src:sidebar_home_icon,alt:\"sidebar-home-icon\"}),/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.hospital\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"sidebar-menu-item \".concat(props.isSidebarOpened&&\"show\"),onClick:goHospitalSignIn,children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"navbar.login\"})})]}),/*#__PURE__*/_jsx(Dimmer,{on:props.isSidebarOpened})]});};export default withRouter(Sidebar);","map":{"version":3,"sources":["/Users/haesol/Desktop/mediround-user-web/src/components/Sidebar/Sidebar.tsx"],"names":["React","useEffect","useRef","useState","Dimmer","karamel_logo","useAuthContext","withRouter","useSelector","getUser","FormattedMessage","Sidebar","props","auth","sideBarRef","isAuthenticated","setIsAuthenticated","userName","setUserName","user","state","current","onClickOutsideSidebarHandler","e","isSidebarOpened","contains","target","sidebarCloseCallback","signOutHandler","logout","history","push","goSignIn","goMypage","goForm","goHospitalSignIn","getUserName","sub","res","result","name","isAuthValid","Object","keys","length","then","window","addEventListener","removeEventListener","sidebar_x_icon","sidebar_home_icon"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Dimmer from \"../Dimmer/Dimmer\";\nimport \"./Sidebar.scss\";\nimport sidebar_x_icon from \"../../images/sidebar-x.svg\";\nimport sidebar_home_icon from \"../../images/sidebar-home-icon.svg\";\nimport karamel_logo from \"../../images/karamel-logo.png\";\nimport { useAuthContext, UserProps } from \"../../auth/auth\";\nimport { RouteComponentProps, withRouter } from \"react-router\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"../../store\";\nimport { getUser } from \"../../api/user\";\nimport { FormattedMessage } from \"react-intl\";\n\ninterface Props extends RouteComponentProps<any> {\n  isSidebarOpened: Boolean;\n  sidebarCloseCallback: () => void;\n}\n\nconst Sidebar = (props: Props) => {\n  const auth = useAuthContext();\n  const sideBarRef = useRef<HTMLDivElement | null>(null);\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean>(false);\n  const [userName, setUserName] = useState(\"\");\n  const user: UserProps = useSelector((state: RootState) => state.user.current);\n\n  const onClickOutsideSidebarHandler = (e: MouseEvent) => {\n    if (\n      props.isSidebarOpened &&\n      !sideBarRef.current?.contains(e.target as Node)\n    ) {\n      props.sidebarCloseCallback();\n    }\n  };\n\n  const signOutHandler = () => {\n    auth?.logout();\n    props.sidebarCloseCallback();\n    props.history.push(\"/landing\");\n  };\n\n  const goSignIn = () => {\n    props.sidebarCloseCallback();\n    props.history.push(\"/signin\");\n  };\n\n  const goMypage = () => {\n    props.sidebarCloseCallback();\n    props.history.push(\"/mypage\");\n  };\n\n  const goForm = () => {\n    props.sidebarCloseCallback();\n    props.history.push(\"/form\");\n  };\n\n  const goHospitalSignIn = () => {\n    props.sidebarCloseCallback();\n    props.history.push(\"/hospital/signin\");\n  };\n\n  useEffect(() => {\n    const getUserName = async () => {\n      const { sub } = user;\n      if (sub) {\n        const res = await getUser({ sub });\n        return res.result.name;\n      }\n    };\n    const isAuthValid = Object.keys(user).length !== 0;\n    setIsAuthenticated(isAuthValid);\n    if (isAuthValid) {\n      getUserName().then((name) => setUserName(name));\n    }\n  }, [user]);\n\n  useEffect(() => {\n    window.addEventListener(\"click\", onClickOutsideSidebarHandler);\n    return () =>\n      window.removeEventListener(\"click\", onClickOutsideSidebarHandler);\n  });\n\n  return (\n    <div className=\"sidebar-container\">\n      <div\n        className={`sidebar-content ${props.isSidebarOpened && \"show\"}`}\n        ref={sideBarRef}\n      >\n        <div\n          className={`sidebar-exit-icon-box ${props.isSidebarOpened && \"show\"}`}\n        >\n          <div className=\"sidebar-title\">\n            <img className=\"sidebar-logo\" src={karamel_logo} alt=\"logo\" />\n          </div>\n          <img\n            className=\"sidebar-exit-icon\"\n            src={sidebar_x_icon}\n            onClick={props.sidebarCloseCallback}\n            alt={\"sidebar-exit-icon\"}\n          />\n          {isAuthenticated && (\n            <div className=\"sidebar-greetings\">\n              <FormattedMessage\n                id=\"navbar.greeting\"\n                values={{ name: userName }}\n              />\n            </div>\n          )}\n        </div>\n        <div\n          className={`sidebar-menu-title-item ${\n            props.isSidebarOpened && \"show\"\n          }`}\n        >\n          <div className=\"sidebar-menu-title-content\">\n            <img\n              className=\"sidebar-menu-title-home-icon\"\n              src={sidebar_home_icon}\n              alt=\"sidebar-home-icon\"\n            />\n            <FormattedMessage id=\"navbar.user\" />\n          </div>\n        </div>\n        {!isAuthenticated && (\n          <div\n            className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}\n            onClick={goSignIn}\n          >\n            <FormattedMessage id=\"navbar.login\" />\n          </div>\n        )}\n        {isAuthenticated && (\n          <div\n            className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}\n            onClick={goMypage}\n          >\n            <FormattedMessage id=\"navbar.myPage\" />\n          </div>\n        )}\n        <div\n          className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}\n          onClick={goForm}\n        >\n          <FormattedMessage id=\"navbar.findHospitals\" />\n        </div>\n        {/* <div className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}>\n          Why Karamel?\n        </div> */}\n        {isAuthenticated && (\n          <div\n            className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}\n            onClick={signOutHandler}\n          >\n            <FormattedMessage id=\"navbar.logout\" />\n          </div>\n        )}\n        <div\n          className={`sidebar-menu-title-item ${\n            props.isSidebarOpened && \"show\"\n          }`}\n        >\n          <div className=\"sidebar-menu-title-content\">\n            <img\n              className=\"sidebar-menu-title-home-icon\"\n              src={sidebar_home_icon}\n              alt=\"sidebar-home-icon\"\n            />\n            <FormattedMessage id=\"navbar.hospital\" />\n          </div>\n        </div>\n        <div\n          className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}\n          onClick={goHospitalSignIn}\n        >\n          <FormattedMessage id=\"navbar.login\" />\n        </div>\n        {/* <div className={`sidebar-menu-item ${props.isSidebarOpened && \"show\"}`}>\n          Partner benefits\n        </div> */}\n      </div>\n      <Dimmer on={props.isSidebarOpened} />\n    </div>\n  );\n};\n\nexport default withRouter(Sidebar);\n"]},"metadata":{},"sourceType":"module"}