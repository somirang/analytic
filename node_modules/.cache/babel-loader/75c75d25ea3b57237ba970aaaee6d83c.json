{"ast":null,"code":"import _slicedToArray from\"/Users/haesol/Desktop/mediround-user-web-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useSelector}from\"react-redux\";import{useHistory,useLocation}from\"react-router\";import{useAuthContext}from\"../auth/auth\";import Button from\"../components/Button/Button\";import UnderlinedButton from\"../components/Button/UnderlinedButton\";import InfoInput from\"../components/Input/InfoInput\";import{parseQuery,phoneLocaleList}from\"../utils\";import\"./SignIn.scss\";import{FormattedMessage}from\"react-intl\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SignIn=function SignIn(props){var auth=useAuthContext();var location=useLocation();var _useState=useState(phoneLocaleList[0].value),_useState2=_slicedToArray(_useState,2),phoneLocale=_useState2[0],setPhoneLocale=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),phoneDigit=_useState4[0],setPhoneDigit=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),phone=_useState6[0],setPhone=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),signInLoading=_useState10[0],setSignInLoading=_useState10[1];var user=useSelector(function(state){return state.user.current;});var history=useHistory();useEffect(function(){var nextLoc=parseQuery(location.search)[\"next\"];if(user!=={}&&nextLoc){history.push(nextLoc);}},[]);useEffect(function(){// Determines phone number i.e. username\nvar fullPhone=phoneLocale+phoneDigit;setPhone(fullPhone);},[phoneLocale,phoneDigit]);var signInHandler=function signInHandler(){setSignInLoading(true);auth===null||auth===void 0?void 0:auth.authenticate(phone,password).then(function(){var nextLoc=parseQuery(location.search)[\"next\"];if(nextLoc){props.history.push(nextLoc);}else{props.history.push(\"/mypage\");}}).catch(function(err){setSignInLoading(false);console.error(err);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"signin-page-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signin-page-title\",children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"logIn.msg\"})}),/*#__PURE__*/_jsx(InfoInput,{title:\"Phone number\",titleId:\"logIn.phone\",type:\"tel\",value:phoneDigit,onChange:function onChange(e){return setPhoneDigit(e.target.value);},optionVals:phoneLocaleList.map(function(obj){return obj.value;}),optionKeys:phoneLocaleList.map(function(obj){return obj.icon+\" \"+obj.value;}),onSelectChange:function onSelectChange(e){return setPhoneLocale(e.target.value);}}),/*#__PURE__*/_jsx(InfoInput,{title:\"Password\",titleId:\"logIn.Password\",type:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"signin-forgot-passwd-text\",children:/*#__PURE__*/_jsx(UnderlinedButton,{text:\"Forgot password?\",textId:\"logIn.forgotYourPassword\",onClick:function onClick(){return props.history.push(\"/forgotPasswd\");}})}),/*#__PURE__*/_jsx(Button,{text:\"Sign In\",textId:\"button.signIn\",theme:\"primary\",shape:\"round\",onClick:signInHandler,isLoading:signInLoading}),/*#__PURE__*/_jsxs(\"div\",{className:\"signin-signup-text\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signin-signup-desc\",children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"logIn.notMember\"})}),/*#__PURE__*/_jsx(UnderlinedButton,{text:\"Sign up\",textId:\"logIn.signUp\",onClick:function onClick(){return props.history.push(\"/signup\");}})]})]});};export default SignIn;","map":{"version":3,"sources":["/Users/haesol/Desktop/mediround-user-web-master/src/pages/SignIn.tsx"],"names":["React","useState","useEffect","useSelector","useHistory","useLocation","useAuthContext","Button","UnderlinedButton","InfoInput","parseQuery","phoneLocaleList","FormattedMessage","SignIn","props","auth","location","value","phoneLocale","setPhoneLocale","phoneDigit","setPhoneDigit","phone","setPhone","password","setPassword","signInLoading","setSignInLoading","user","state","current","history","nextLoc","search","push","fullPhone","signInHandler","authenticate","then","catch","err","console","error","e","target","map","obj","icon"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { RouteComponentProps, useHistory, useLocation } from \"react-router\";\nimport { useAuthContext } from \"../auth/auth\";\nimport Button from \"../components/Button/Button\";\nimport UnderlinedButton from \"../components/Button/UnderlinedButton\";\nimport InfoInput from \"../components/Input/InfoInput\";\nimport { RootState } from \"../store\";\nimport { parseQuery, phoneLocaleList } from \"../utils\";\nimport \"./SignIn.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst SignIn = (props: RouteComponentProps) => {\n  const auth = useAuthContext();\n  const location = useLocation();\n  const [phoneLocale, setPhoneLocale] = useState(phoneLocaleList[0].value);\n  const [phoneDigit, setPhoneDigit] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [signInLoading, setSignInLoading] = useState(false);\n  const user = useSelector((state: RootState) => state.user.current);\n  const history = useHistory();\n\n  useEffect(() => {\n    const nextLoc = parseQuery(location.search)[\"next\"];\n    if (user !== {} && nextLoc) {\n      history.push(nextLoc);\n    }\n  }, []);\n\n  useEffect(() => {\n    // Determines phone number i.e. username\n    const fullPhone = phoneLocale + phoneDigit;\n    setPhone(fullPhone);\n  }, [phoneLocale, phoneDigit]);\n\n  const signInHandler = () => {\n    setSignInLoading(true);\n    auth\n      ?.authenticate(phone, password)\n      .then(() => {\n        const nextLoc = parseQuery(location.search)[\"next\"];\n        if (nextLoc) {\n          props.history.push(nextLoc);\n        } else {\n          props.history.push(\"/mypage\");\n        }\n      })\n      .catch((err) => {\n        setSignInLoading(false);\n        console.error(err);\n      });\n  };\n\n  return (\n    <div className=\"signin-page-container\">\n      <div className=\"signin-page-title\">\n        <FormattedMessage id=\"logIn.msg\" />\n      </div>\n      <InfoInput\n        title=\"Phone number\"\n        titleId=\"logIn.phone\"\n        type=\"tel\"\n        value={phoneDigit}\n        onChange={(e) => setPhoneDigit(e.target.value)}\n        optionVals={phoneLocaleList.map((obj) => obj.value)}\n        optionKeys={phoneLocaleList.map((obj) => obj.icon + \" \" + obj.value)}\n        onSelectChange={(e) => setPhoneLocale(e.target.value)}\n      />\n      <InfoInput\n        title=\"Password\"\n        titleId=\"logIn.Password\"\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n      />\n      <div className=\"signin-forgot-passwd-text\">\n        <UnderlinedButton\n          text=\"Forgot password?\"\n          textId=\"logIn.forgotYourPassword\"\n          onClick={() => props.history.push(\"/forgotPasswd\")}\n        />\n      </div>\n      <Button\n        text=\"Sign In\"\n        textId=\"button.signIn\"\n        theme=\"primary\"\n        shape=\"round\"\n        onClick={signInHandler}\n        isLoading={signInLoading}\n      />\n      <div className=\"signin-signup-text\">\n        <div className=\"signin-signup-desc\">\n          <FormattedMessage id=\"logIn.notMember\" />\n        </div>\n        <UnderlinedButton\n          text=\"Sign up\"\n          textId=\"logIn.signUp\"\n          onClick={() => props.history.push(\"/signup\")}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}