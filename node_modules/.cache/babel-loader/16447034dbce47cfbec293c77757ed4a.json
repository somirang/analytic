{"ast":null,"code":"var _jsxFileName = \"/Users/haesol/Desktop/mediround-user-web-master/src/pages/Hospital/Containers/Preview.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { getHospitalQuote, respondQuote } from \"../../../api/quote\";\nimport Button from \"../../../components/Button/Button\";\nimport { RequestBody, RequestHeader } from \"../../../components/Card/RequestCard\";\nimport InfoInput from \"../../../components/Input/InfoInput\";\nimport ProcInput from \"../../../components/Input/ProcInput\";\nimport purple_go_back_arrow_icon from \"../../../images/purple-go-back-arrow-icon.svg\";\nimport { QuoteDetailHeader } from \"../../My/QuoteDetail\";\nimport { EmptyDesc, Loading } from \"./Request\";\nimport \"./Preview.scss\";\nimport { getInterestedProcsFromQuote, getKstDatetime } from \"../../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { FormattedMessage } from \"react-intl\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initProc = {\n  name: \"\"\n};\n\nconst Preview = props => {\n  _s();\n\n  const [recommendedProcs, setRecommendedProcs] = useState([initProc]);\n  const [videoConfLinks, setVideoConfLinks] = useState([\"\", \"\", \"\"]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [previewQuote, setPreviewQuote] = useState();\n  const hospital = useSelector(state => state.hospital.current);\n\n  const updateNthLink = (nth, newLink) => {\n    const newLinks = [...videoConfLinks];\n    newLinks[nth] = newLink;\n    setVideoConfLinks(newLinks);\n  };\n\n  const updateWrapper = nth => (key, val) => {\n    const newProcs = [...recommendedProcs];\n    const newProc = { ...newProcs[nth]\n    };\n    newProc[key] = val;\n    newProcs[nth] = newProc;\n    setRecommendedProcs(newProcs);\n  };\n\n  const addMoreProc = () => {\n    const newProcs = [...recommendedProcs];\n    newProcs.push(initProc);\n    setRecommendedProcs(newProcs);\n  };\n\n  const deleteNthProc = nth => () => {\n    const newProcs = [...recommendedProcs];\n    newProcs.splice(nth, 1);\n    setRecommendedProcs(newProcs);\n  };\n\n  useEffect(() => {\n    setIsLoading(true);\n\n    const fetchRequestQuotes = async () => {\n      // TODO: get hospital Id\n      const quoteData = await getHospitalQuote({\n        hid: \"h1\",\n        qid: props.match.params.quoteId\n      });\n      return quoteData.result;\n    };\n\n    fetchRequestQuotes().then(quote => {\n      setPreviewQuote(quote);\n      setIsLoading(false);\n    }).catch(e => {\n      console.error(\"Preview\", e);\n      setIsLoading(false);\n    });\n  }, []);\n\n  const sendQuoteResponse = async () => {\n    setIsSending(true);\n    const isResponseSuccess = await respondQuote({\n      hid: \"h1\",\n      qid: props.match.params.quoteId,\n      meetLinks: videoConfLinks,\n      suggestedSurgeries: recommendedProcs,\n      responseTime: new Date().getTime()\n    });\n\n    if (isResponseSuccess) {\n      setIsSending(false);\n      props.history.push(\"/hospital/my/sent\");\n    } else {\n      setIsSending(false); // TODO: setShowErrorModal(true);\n    }\n  };\n\n  const isResponseFilled = () => {\n    const isVideoConfLinksFilled = videoConfLinks.every(link => link !== \"\");\n    return isVideoConfLinksFilled;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: isLoading ? /*#__PURE__*/_jsxDEV(Loading, {\n      containerType: \"preview\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }, this) : !previewQuote ? /*#__PURE__*/_jsxDEV(EmptyDesc, {\n      message: \"No quote found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"hospital-mypage-preview-background-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"hospital-mypage-preview-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hospital-mypage-go-back\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hospital-mypage-go-back-box\",\n            onClick: () => props.history.push(\"/hospital/my\"),\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"hospital-mypage-go-back-icon\",\n              src: purple_go_back_arrow_icon,\n              alt: \"mypage-go-back-icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(FormattedMessage, {\n              id: \"myPage\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"hospital-mypage-sub-container-collection\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hospital-mypage-sub-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-title\",\n              children: \"Request\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-item\",\n              children: /*#__PURE__*/_jsxDEV(RequestHeader, {\n                userName: previewQuote.userInfo.name,\n                receivedTime: getKstDatetime(previewQuote.quoteInfo.timestamp)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(RequestBody, {\n              quote: previewQuote.quoteInfo.quote,\n              comment: previewQuote.quoteInfo.comment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hospital-mypage-sub-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-title\",\n              children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                id: \"quote.yourQuotes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-description\",\n              children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                id: \"quote.previewOfYourQuotes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-quote-preview-container\",\n              children: [/*#__PURE__*/_jsxDEV(QuoteDetailHeader, {\n                name: previewQuote.userInfo.name,\n                hospitalName: hospital.name,\n                hospitalAddr: hospital.addr,\n                hospitalAbout: hospital.about,\n                interestedProcedures: getInterestedProcsFromQuote(previewQuote.quoteInfo.quote),\n                isPreview: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"hospital-mypage-quote-preview-proc-recommend-container\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"hospital-mypage-quote-preview-proc-recommend-title\",\n                  children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                    id: \"quote.procedureRecommendation\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 185,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"hospital-mypage-quote-preview-proc-recommend-input-collection\",\n                  children: recommendedProcs.map((proc, ind) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"hospital-mypage-quote-preview-proc-recommend-input-container\",\n                    children: /*#__PURE__*/_jsxDEV(ProcInput, { ...proc,\n                      update: updateWrapper(ind),\n                      deletable: ind !== 0,\n                      deleteHandler: deleteNthProc(ind)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 193,\n                      columnNumber: 27\n                    }, this)\n                  }, ind, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 189,\n                    columnNumber: 25\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"hospital-mypage-quote-preview-proc-recommend-more-container\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"hospital-mypage-quote-preview-proc-recommend-more-text\",\n                    onClick: addMoreProc,\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"hospital-mypage-quote-preview-proc-recommend-more-plus\",\n                      children: \"+\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 207,\n                      columnNumber: 25\n                    }, this), \" \", /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                      id: \"quote.addMoreProcedure\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 210,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 203,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 202,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hospital-mypage-sub-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-title\",\n              children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                id: \"quote.videoConferenceLink\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-sub-container-description\",\n              children: /*#__PURE__*/_jsxDEV(FormattedMessage, {\n                id: \"quote.videoConferencePut\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-video-conf-link-input-collection\",\n              children: videoConfLinks.map((link, ind) => /*#__PURE__*/_jsxDEV(InfoInput, {\n                title: `Day ${(ind + 1).toString()}`,\n                value: link,\n                onChange: e => updateNthLink(ind, e.target.value)\n              }, ind, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"hospital-mypage-send-quote-button-container\",\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                text: \"Send quote\",\n                shape: \"round\",\n                theme: \"primary\",\n                onClick: sendQuoteResponse,\n                isDisabled: !isResponseFilled(),\n                isLoading: isSending\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n\n_s(Preview, \"d7z+waIHKWa1+wE4cCntwdM8t24=\", false, function () {\n  return [useSelector];\n});\n\n_c = Preview;\nexport default Preview;\n\nvar _c;\n\n$RefreshReg$(_c, \"Preview\");","map":{"version":3,"sources":["/Users/haesol/Desktop/mediround-user-web-master/src/pages/Hospital/Containers/Preview.tsx"],"names":["React","useEffect","useState","getHospitalQuote","respondQuote","Button","RequestBody","RequestHeader","InfoInput","ProcInput","QuoteDetailHeader","EmptyDesc","Loading","getInterestedProcsFromQuote","getKstDatetime","useSelector","FormattedMessage","initProc","name","Preview","props","recommendedProcs","setRecommendedProcs","videoConfLinks","setVideoConfLinks","isLoading","setIsLoading","isSending","setIsSending","previewQuote","setPreviewQuote","hospital","state","current","updateNthLink","nth","newLink","newLinks","updateWrapper","key","val","newProcs","newProc","addMoreProc","push","deleteNthProc","splice","fetchRequestQuotes","quoteData","hid","qid","match","params","quoteId","result","then","quote","catch","e","console","error","sendQuoteResponse","isResponseSuccess","meetLinks","suggestedSurgeries","responseTime","Date","getTime","history","isResponseFilled","isVideoConfLinksFilled","every","link","purple_go_back_arrow_icon","userInfo","quoteInfo","timestamp","comment","addr","about","map","proc","ind","toString","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { RouteComponentProps } from \"react-router\";\nimport { getHospitalQuote, respondQuote } from \"../../../api/quote\";\nimport Button from \"../../../components/Button/Button\";\nimport {\n  RequestBody,\n  RequestHeader,\n} from \"../../../components/Card/RequestCard\";\nimport InfoInput from \"../../../components/Input/InfoInput\";\nimport ProcInput from \"../../../components/Input/ProcInput\";\nimport purple_go_back_arrow_icon from \"../../../images/purple-go-back-arrow-icon.svg\";\nimport { QuoteDetailHeader } from \"../../My/QuoteDetail\";\nimport { EmptyDesc, Loading, QuoteDataProps } from \"./Request\";\nimport \"./Preview.scss\";\nimport { getInterestedProcsFromQuote, getKstDatetime } from \"../../../utils\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"../../../store\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport interface Procedure {\n  name: string;\n  priceMin?: string;\n  priceMax?: string;\n  methodology?: string;\n  operationTime?: string;\n  anesthesiaType?: string;\n  recoveryTime?: string;\n  sutureRemovalTime?: string;\n  warning?: string;\n  afterCare?: string;\n}\n\nexport interface Hospital {\n  id?: string;\n  name?: string;\n  addr?: string;\n  about?: string;\n  procs?: string[];\n}\n\nconst initProc: Procedure = { name: \"\" };\n\nconst Preview = (props: RouteComponentProps<any>) => {\n  const [recommendedProcs, setRecommendedProcs] = useState<Procedure[]>([\n    initProc,\n  ]);\n  const [videoConfLinks, setVideoConfLinks] = useState<string[]>([\"\", \"\", \"\"]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [previewQuote, setPreviewQuote] = useState<QuoteDataProps>();\n  const hospital: Hospital = useSelector(\n    (state: RootState) => state.hospital.current,\n  );\n\n  const updateNthLink = (nth: number, newLink: string) => {\n    const newLinks = [...videoConfLinks];\n    newLinks[nth] = newLink;\n    setVideoConfLinks(newLinks);\n  };\n\n  const updateWrapper = (nth: number) => (key: string, val: any) => {\n    const newProcs = [...recommendedProcs];\n    const newProc: { [key: string]: any; name: string } = { ...newProcs[nth] };\n    newProc[key] = val;\n    newProcs[nth] = newProc;\n    setRecommendedProcs(newProcs);\n  };\n\n  const addMoreProc = () => {\n    const newProcs = [...recommendedProcs];\n    newProcs.push(initProc);\n    setRecommendedProcs(newProcs);\n  };\n\n  const deleteNthProc = (nth: number) => () => {\n    const newProcs = [...recommendedProcs];\n    newProcs.splice(nth, 1);\n    setRecommendedProcs(newProcs);\n  };\n\n  useEffect(() => {\n    setIsLoading(true);\n    const fetchRequestQuotes = async () => {\n      // TODO: get hospital Id\n      const quoteData = await getHospitalQuote({\n        hid: \"h1\",\n        qid: props.match.params.quoteId,\n      });\n      return quoteData.result;\n    };\n    fetchRequestQuotes()\n      .then((quote: QuoteDataProps) => {\n        setPreviewQuote(quote);\n        setIsLoading(false);\n      })\n      .catch((e) => {\n        console.error(\"Preview\", e);\n        setIsLoading(false);\n      });\n  }, []);\n\n  const sendQuoteResponse = async () => {\n    setIsSending(true);\n    const isResponseSuccess = await respondQuote({\n      hid: \"h1\",\n      qid: props.match.params.quoteId,\n      meetLinks: videoConfLinks,\n      suggestedSurgeries: recommendedProcs,\n      responseTime: new Date().getTime(),\n    });\n    if (isResponseSuccess) {\n      setIsSending(false);\n      props.history.push(\"/hospital/my/sent\");\n    } else {\n      setIsSending(false);\n      // TODO: setShowErrorModal(true);\n    }\n  };\n\n  const isResponseFilled = () => {\n    const isVideoConfLinksFilled = videoConfLinks.every((link) => link !== \"\");\n    return isVideoConfLinksFilled;\n  };\n\n  return (\n    <>\n      {isLoading ? (\n        <Loading containerType=\"preview\" />\n      ) : !previewQuote ? (\n        <EmptyDesc message=\"No quote found\" />\n      ) : (\n        <div className=\"hospital-mypage-preview-background-container\">\n          <div className=\"hospital-mypage-preview-container\">\n            <div className=\"hospital-mypage-go-back\">\n              <div\n                className=\"hospital-mypage-go-back-box\"\n                onClick={() => props.history.push(\"/hospital/my\")}\n              >\n                <img\n                  className=\"hospital-mypage-go-back-icon\"\n                  src={purple_go_back_arrow_icon}\n                  alt=\"mypage-go-back-icon\"\n                />\n                <FormattedMessage id=\"myPage\" />\n              </div>\n            </div>\n            <div className=\"hospital-mypage-sub-container-collection\">\n              <div className=\"hospital-mypage-sub-container\">\n                <div className=\"hospital-mypage-sub-container-title\">\n                  Request\n                </div>\n                <div className=\"hospital-mypage-sub-container-item\">\n                  <RequestHeader\n                    userName={previewQuote.userInfo.name}\n                    receivedTime={getKstDatetime(\n                      previewQuote.quoteInfo.timestamp,\n                    )}\n                  />\n                </div>\n                <RequestBody\n                  quote={previewQuote.quoteInfo.quote}\n                  comment={previewQuote.quoteInfo.comment}\n                />\n              </div>\n              <div className=\"hospital-mypage-sub-container\">\n                <div className=\"hospital-mypage-sub-container-title\">\n                  <FormattedMessage id=\"quote.yourQuotes\" />\n                </div>\n                <div className=\"hospital-mypage-sub-container-description\">\n                  <FormattedMessage id=\"quote.previewOfYourQuotes\" />\n                </div>\n                <div className=\"hospital-mypage-quote-preview-container\">\n                  <QuoteDetailHeader\n                    name={previewQuote.userInfo.name}\n                    hospitalName={hospital.name!}\n                    hospitalAddr={hospital.addr!}\n                    hospitalAbout={hospital.about!}\n                    interestedProcedures={getInterestedProcsFromQuote(\n                      previewQuote.quoteInfo.quote,\n                    )}\n                    isPreview={true}\n                  />\n                  <div className=\"hospital-mypage-quote-preview-proc-recommend-container\">\n                    <div className=\"hospital-mypage-quote-preview-proc-recommend-title\">\n                      <FormattedMessage id=\"quote.procedureRecommendation\" />\n                    </div>\n                    <div className=\"hospital-mypage-quote-preview-proc-recommend-input-collection\">\n                      {recommendedProcs.map((proc, ind) => (\n                        <div\n                          key={ind}\n                          className=\"hospital-mypage-quote-preview-proc-recommend-input-container\"\n                        >\n                          <ProcInput\n                            {...proc}\n                            update={updateWrapper(ind)}\n                            deletable={ind !== 0}\n                            deleteHandler={deleteNthProc(ind)}\n                          />\n                        </div>\n                      ))}\n                    </div>\n                    <div className=\"hospital-mypage-quote-preview-proc-recommend-more-container\">\n                      <div\n                        className=\"hospital-mypage-quote-preview-proc-recommend-more-text\"\n                        onClick={addMoreProc}\n                      >\n                        <div className=\"hospital-mypage-quote-preview-proc-recommend-more-plus\">\n                          +\n                        </div>{\" \"}\n                        <FormattedMessage id=\"quote.addMoreProcedure\" />\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"hospital-mypage-sub-container\">\n                <div className=\"hospital-mypage-sub-container-title\">\n                  <FormattedMessage id=\"quote.videoConferenceLink\" />\n                </div>\n                <div className=\"hospital-mypage-sub-container-description\">\n                  <FormattedMessage id=\"quote.videoConferencePut\" />\n                </div>\n                <div className=\"hospital-mypage-video-conf-link-input-collection\">\n                  {videoConfLinks.map((link, ind) => (\n                    <InfoInput\n                      key={ind}\n                      title={`Day ${(ind + 1).toString()}`}\n                      value={link}\n                      onChange={(e) => updateNthLink(ind, e.target.value)}\n                    />\n                  ))}\n                </div>\n                <div className=\"hospital-mypage-send-quote-button-container\">\n                  <Button\n                    text=\"Send quote\"\n                    shape=\"round\"\n                    theme=\"primary\"\n                    onClick={sendQuoteResponse}\n                    isDisabled={!isResponseFilled()}\n                    isLoading={isSending}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Preview;\n"]},"metadata":{},"sourceType":"module"}